<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Dashboard - BakeTrack</title>
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-container">
                <img src="images/main_logo.jpg" alt="Bakery Logo" class="logo">
                <h2>BakeTrack</h2>
            </div>
            <nav class="menu">
                <ul>
                    <li class="active" data-section="order">
                        <i class="fas fa-shopping-basket"></i>
                        <span>Order Products</span>
                    </li>
                    <li data-section="menu">
                        <i class="fas fa-list"></i>
                        <span>Menu</span>
                    </li>
                    <li data-section="history">
                        <i class="fas fa-history"></i>
                        <span>Order History</span>
                    </li>
                    <li data-section="feedback">
                        <i class="fas fa-comment-dots"></i>
                        <span>Give Feedback</span>
                    </li>
                    <li data-section="recommend">
                        <i class="fas fa-star"></i>
                        <span>Recommended</span>
                    </li>
                </ul>
            </nav>
            <button class="logout" type="button">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
        <!-- Main Content -->
        <div class="main-content">
            <!-- Order Products Section -->
            <section id="order" class="content-section active">
                <h2>Order Products</h2>
                <div class="order-products improved-order-ui">
                    <form id="orderForm">
                        <div id="orderItems">
                            <div class="order-item">
                                <div class="form-group">
                                    <label>Product</label>
                                    <select class="orderProduct" required>
                                        <option value="">Select Product</option>
                                        <option value="Bread">Bread</option>
                                        <option value="Cake">Cake</option>
                                        <option value="Pastry">Pastry</option>
                                        <option value="Cookies">Cookies</option>
                                        <option value="Brownie">Brownie</option>
                                        <option value="Croissant">Croissant</option>
                                        <option value="Cup Cake">Cup Cake</option>
                                        <option value="Dispasand">Dispasand</option>
                                        <option value="Egg Puff">Egg Puff</option>
                                        <option value="Garlic Loaf">Garlic Loaf</option>
                                        <option value="Masala Bun">Masala Bun</option>
                                        <option value="Pav Bread">Pav Bread</option>
                                        <option value="Rusk">Rusk</option>
                                        <option value="Samosa">Samosa</option>
                                        <option value="Veg Puff">Veg Puff</option>
                                        <option value="Cheese Sandwich">Cheese Sandwich</option>
                                        <option value="Bread Pakora">Bread Pakora</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Quantity</label>
                                    <input type="number" class="orderQuantity" min="1" required>
                                </div>
                                <div class="form-group">
                                    <label for="orderDescription">Order Description</label>
                                    <input type="text" id="orderDescription" placeholder="e.g. spicy, eggless, etc.">
                                </div>
                                <div class="form-group product-image-preview"></div>
                                <div class="form-group">
                                    <label>Payment Method</label>
                                    <select id="paymentMethod" required>
                                        <option value="cash">Cash</option>
                                        <option value="netbanking">Netbanking</option>
                                    </select>
                                </div>
                                <div id="qrCodeContainer" style="display:none; margin-top:10px;">
                                    <label>Scan to Pay (Netbanking):</label><br>
                                    <img src="images/MyQR.jpeg" alt="QR Code" style="width:180px; border:1px solid #ccc; border-radius:8px;">
                                </div>
                                <button type="button" class="remove-item" style="display:none">×</button>
                            </div>
                        </div>
                        <div class="order-actions">
                            <button type="button" id="addOrderItem">Add Item</button>
                            <button type="button" id="clearOrder" class="clear-order">Clear Order</button>
                        </div>
                        <button type="submit" class="place-order-btn">Place Order</button>
                    </form>
                    <div class="order-total-display">
                        <strong>Total Cost: </strong><span id="orderTotal">0</span> rupees
                    </div>
                </div>
            </section>
            <!-- Menu Section -->
            <section id="menu" class="content-section">
                <h2>Menu</h2>
                <div class="menu-list" id="menuList">
                    <!-- Menu items will be populated dynamically as cards -->
                </div>
            </section>
            <!-- Order History Section -->
            <section id="history" class="content-section">
                <h2>Order History</h2>
                <div class="order-history">
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Bill</th>
                            </tr>
                        </thead>
                        <tbody id="orderHistoryBody">
                            <!-- Orders will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </section>
            <!-- Feedback Section -->
            <section id="feedback" class="content-section">
                <h2>Give Feedback</h2>
                <form id="feedbackForm">
                    <div class="form-group">
                        <label>Rating</label>
                        <select id="feedbackRating" required>
                            <option value="">Select Rating</option>
                            <option value="5">★★★★★</option>
                            <option value="4">★★★★</option>
                            <option value="3">★★★</option>
                            <option value="2">★★</option>
                            <option value="1">★</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Comment</label>
                        <textarea id="feedbackComment" rows="3" required></textarea>
                    </div>
                    <button type="submit">Submit Feedback</button>
                </form>
            </section>
            <!-- Recommended Products Section -->
            <section id="recommend" class="content-section">
                <h2>Recommended Products</h2>
                <div class="menu-list" id="recommendedList">
                    <!-- Recommended products will be shown here as cards -->
                </div>
            </section>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-analytics.js";
      import { getDatabase, ref, set, get, push, onValue } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-database.js";
      import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-auth.js";
      
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyACwNtH0HJ-z5jvjI634BDZy2uPI3x6A6A",
        authDomain: "newbakery-31596.firebaseapp.com",
        databaseURL: "https://newbakery-31596-default-rtdb.asia-southeast1.firebasedatabase.app/",
        projectId: "newbakery-31596",
        storageBucket: "newbakery-31596.firebasestorage.app",
        messagingSenderId: "502783295506",
        appId: "1:502783295506:web:2cd1aed167c92d50d5d8cb",
        measurementId: "G-C4H7WBEZKF"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const database = getDatabase(app);
      const auth = getAuth(app);
      
      // Make Firebase available globally
      window.firebase = {
        app: app,
        database: database,
        ref: ref,
        set: set,
        get: get,
        push: push,
        onValue: onValue,
        auth: auth,
        signOut: signOut,
        onAuthStateChanged: onAuthStateChanged
      };
      
      // Check if user is logged in
      onAuthStateChanged(auth, function(user) {
        if (!user) {
          // User is not logged in, redirect to login page
          window.location.href = 'index.html';
        } else {
          // Check if user has customer role
          const customerRef = ref(database, 'customers/' + user.uid);
          get(customerRef).then(function(snapshot) {
            if (!snapshot.exists()) {
              // User is not a customer, sign them out and redirect
              signOut(auth).then(() => {
                alert('Access denied: You do not have customer permissions.');
                window.location.href = 'index.html';
              });
            }
          });
        }
      });
    </script>
    <script src="customer-dashboard.js"></script>
</body>
</html> 